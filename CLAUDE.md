# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Commands

```bash
# Development
pnpm dev          # Start development server
pnpm build        # Production build (runs prisma generate first)
pnpm format       # Format code with Prettier

# Database
pnpm seed         # Seed database with initial data (scripts/seed.ts)
npx prisma migrate dev    # Run migrations in development
npx prisma generate       # Regenerate Prisma client
```

## Architecture

This is a UmiJS Max application with Ant Design Pro components, using Prisma ORM with SQLite for the backend.

### Key Architectural Patterns

**Frontend-Backend Integration:**

- Frontend API services in `src/services/demo/` are auto-generated by OneAPI from backend specs
- Backend API routes in `src/api/` are Vercel serverless functions
- Data fetching uses React Query (useQuery/useMutation) via `@umijs/max`

**Database Access:**

- Prisma client initialized in `lib/prisma.ts` with LibSQL adapter
- Schema defined in `prisma/schema.prisma`
- Generated client outputs to `generated/prisma/`

**Routing:**

- Routes defined in `.umirc.ts` under `routes` config
- Page components in `src/pages/` follow UmiJS conventions
- Layout wrapper in `src/layouts/BasicLayout.tsx`

**State Management:**

- Global models in `src/models/` (UmiJS dva-style hooks)
- Access control logic in `src/access.ts`

### Project Structure

```
src/
├── api/          # Vercel serverless API routes
├── pages/        # Route page components
├── services/     # Auto-generated API client (OneAPI)
├── models/       # Global state models
├── components/   # Reusable components
├── layouts/      # Layout wrappers
└── access.ts     # Access control rules

lib/prisma.ts     # Prisma client singleton
prisma/schema.prisma  # Database schema
```

## Code Style

- Pre-commit hooks run ESLint (`max lint --fix`) and Prettier
- Use TypeScript for all new code
- React components use hooks pattern
- UI uses Ant Design Pro components (ProTable, ModalForm, etc.)
